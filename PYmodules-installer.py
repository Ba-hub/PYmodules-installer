# Made By : Ghosthub

import base64
exec(base64.b64decode('aW1wb3J0IGFpb2ZpbGVzDQppbXBvcnQgYXN5bmNpbw0KaW1wb3J0IGFyZ3BhcnNlDQpmcm9tIGNwcmludCBpbXBvcnQgKg0KaW1wb3J0IHN1YnByb2Nlc3MgYXMgcHJvY3gNCmltcG9ydCBzeXMNCg0KDQpwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0nSXQgZmluZCBhbGwgcmVxdWVybWVudCBtb2R1bGVzIGFuZCBpbnN0YWxsIHRoZW0nKQ0KcGFyc2VyLmFkZF9hcmd1bWVudCgnRmlsZXBhdGgnLCBtZXRhdmFyPSdGaWxlIHBhdGgnLCB0eXBlPXN0ciwgbmFyZ3M9JysnLA0KICAgICAgICAgICAgICAgICAgICBoZWxwPSdGaWxlcGF0aCB0byBkZXRlY3QgcmVxdWVybWVudCcpDQoNCmFyZ3MgPSBwYXJzZXIucGFyc2VfYXJncygpDQphc3luYyBkZWYgbWFpbihmaWxlbmFtZSk6DQogICAgcGFja2FnZXMgPSBbXQ0KICAgIGNvbW1hbmQgPSBbXQ0KICAgIGFzeW5jIHdpdGggYWlvZmlsZXMub3BlbihmaWxlbmFtZSwgbW9kZT0ncicpIGFzIGY6DQogICAgICAgIGFzeW5jIGZvciBsaW5leCBpbiBmOg0KICAgICAgICAgICAgbGluZSA9IGxpbmV4LnN0cmlwKCkNCiAgICAgICAgICAgIGlmIGxpbmUuc3RhcnRzd2l0aCgiZnJvbSIpIG9yIGxpbmUuc3RhcnRzd2l0aCgiaW1wb3J0Iik6DQogICAgICAgICAgICAgICAgbnggPSBsaW5lLnNwbGl0KCIgIilbMV0NCiAgICAgICAgICAgICAgICBpZiAiLCIgaW4gbng6DQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBueC5zcGxpdCgiLCIpDQogICAgICAgICAgICAgICAgICAgIGZvciB4eiBpbiBkYXRhOg0KICAgICAgICAgICAgICAgICAgICAgICAgcGFja2FnZXMuYXBwZW5kKHh6KQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIHBhY2thZ2VzLmFwcGVuZChueCkNCiAgICAgICAgY3ByaW50Lndhcm4oIkRlcGVuZGVuc2lzIEZvdW5kID0+IikNCiAgICAgICAgZXhlY3ggPSBzeXMuZXhlY3V0YWJsZQ0KICAgICAgICBmb3IgaSBpbiBwYWNrYWdlczoNCiAgICAgICAgICAgIGNvbW1hbmQuYXBwZW5kKGYie2V4ZWN4fSAtbSAgcGlwIGluc3RhbGwge2l9IikNCiAgICAgICAgICAgIGNwcmludC5vayhpKQ0KICAgICAgICBmb3IgaSBpbiBjb21tYW5kOg0KICAgICAgICAgICAgY3ByaW50Lm9rKGkpDQogICAgICAgICAgICByZXN1bHQgPSBwcm9jeC5ydW4oaSwgc2hlbGw9VHJ1ZSwgY2FwdHVyZV9vdXRwdXQ9VHJ1ZQ0KICAgICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICByZXggPSByZXN1bHQuc3Rkb3V0LmRlY29kZSgpDQogICAgICAgICAgICBpZiByZXggPT0gIiI6DQogICAgICAgICAgICAgICAgcmV4ID0gcmVzdWx0LnN0ZGVyci5kZWNvZGUoKQ0KICAgICAgICAgICAgICAgIGNwcmludC5lcnIocmV4KQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBjcHJpbnQuaW5mbyhyZXgpDQoNCmZpbGUgPSBhcmdzLkZpbGVwYXRoWzBdDQpjcHJpbnQuaW5mbyhmaWxlKSAgICANCmFzeW5jaW8ucnVuKG1haW4oZmlsZSkp'))